     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 	EXTERN	_table_8_565
     9 00000000                                 [FILE "sheet.c"]
    10                                          [SECTION .text]
    11 00000000                                 	GLOBAL	_shtctl_init
    12 00000000                                 _shtctl_init:
    13 00000000 55                              	PUSH	EBP
    14 00000001 89 E5                           	MOV	EBP,ESP
    15 00000003 57                              	PUSH	EDI
    16 00000004 56                              	PUSH	ESI
    17 00000005 53                              	PUSH	EBX
    18 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    19 00000009 68 00002C18                     	PUSH	11288
    20 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    21 00000011 56                              	PUSH	ESI
    22 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    23 00000017 89 C3                           	MOV	EBX,EAX
    24 00000019 58                              	POP	EAX
    25 0000001A 5A                              	POP	EDX
    26 0000001B 85 DB                           	TEST	EBX,EBX
    27 0000001D 74 4A                           	JE	L3
    28 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    29 00000022 0F AF C7                        	IMUL	EAX,EDI
    30 00000025 50                              	PUSH	EAX
    31 00000026 56                              	PUSH	ESI
    32 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    33 0000002C 85 C0                           	TEST	EAX,EAX
    34 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    35 00000031 5A                              	POP	EDX
    36 00000032 59                              	POP	ECX
    37 00000033 74 3E                           	JE	L11
    38 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    39 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    40 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    41 0000003D 8D 93 000027D8                  	LEA	EDX,DWORD [10200+EBX]
    42 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    43 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    44 00000049 89 D8                           	MOV	EAX,EBX
    45 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    46 00000052                                 L9:
    47 00000052 C7 80 00000434 00000000         	MOV	DWORD [1076+EAX],0
    48 0000005C 89 98 00000438                  	MOV	DWORD [1080+EAX],EBX
    49 00000062 83 C0 28                        	ADD	EAX,40
    50 00000065 39 D0                           	CMP	EAX,EDX
    51 00000067 7E E9                           	JLE	L9
    52 00000069                                 L3:
    53 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    54 0000006C 89 D8                           	MOV	EAX,EBX
    55 0000006E 5B                              	POP	EBX
    56 0000006F 5E                              	POP	ESI
    57 00000070 5F                              	POP	EDI
    58 00000071 5D                              	POP	EBP
    59 00000072 C3                              	RET
    60 00000073                                 L11:
    61 00000073 68 00002C18                     	PUSH	11288
    62 00000078 53                              	PUSH	EBX
    63 00000079 56                              	PUSH	ESI
    64 0000007A E8 [00000000]                   	CALL	_memman_free_4k
    65 0000007F 83 C4 0C                        	ADD	ESP,12
    66 00000082 EB E5                           	JMP	L3
    67 00000084                                 	GLOBAL	_sheet_alloc
    68 00000084                                 _sheet_alloc:
    69 00000084 55                              	PUSH	EBP
    70 00000085 31 D2                           	XOR	EDX,EDX
    71 00000087 89 E5                           	MOV	EBP,ESP
    72 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    73 0000008C 05 00000418                     	ADD	EAX,1048
    74 00000091                                 L18:
    75 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    76 00000095 74 10                           	JE	L21
    77 00000097 42                              	INC	EDX
    78 00000098 83 C0 28                        	ADD	EAX,40
    79 0000009B 81 FA 000000FF                  	CMP	EDX,255
    80 000000A1 7E EE                           	JLE	L18
    81 000000A3 31 C0                           	XOR	EAX,EAX
    82 000000A5                                 L12:
    83 000000A5 5D                              	POP	EBP
    84 000000A6 C3                              	RET
    85 000000A7                                 L21:
    86 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    87 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    88 000000B5 C7 40 24 00000000               	MOV	DWORD [36+EAX],0
    89 000000BC EB E7                           	JMP	L12
    90 000000BE                                 	GLOBAL	_sheet_setbuf
    91 000000BE                                 _sheet_setbuf:
    92 000000BE 55                              	PUSH	EBP
    93 000000BF 89 E5                           	MOV	EBP,ESP
    94 000000C1 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    95 000000C4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    96 000000C7 8B 4D 18                        	MOV	ECX,DWORD [24+EBP]
    97 000000CA 89 02                           	MOV	DWORD [EDX],EAX
    98 000000CC 83 F9 FF                        	CMP	ECX,-1
    99 000000CF 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   100 000000D2 89 42 04                        	MOV	DWORD [4+EDX],EAX
   101 000000D5 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   102 000000D8 89 42 08                        	MOV	DWORD [8+EDX],EAX
   103 000000DB 74 0D                           	JE	L23
   104 000000DD 0F B7 84 09 [00000000]          	MOVZX	EAX,WORD [_table_8_565+ECX+ECX*1]
   105 000000E5 89 42 14                        	MOV	DWORD [20+EDX],EAX
   106 000000E8                                 L22:
   107 000000E8 5D                              	POP	EBP
   108 000000E9 C3                              	RET
   109 000000EA                                 L23:
   110 000000EA C7 42 14 FFFFFFFF               	MOV	DWORD [20+EDX],-1
   111 000000F1 EB F5                           	JMP	L22
   112 000000F3                                 	GLOBAL	_sheet_refreshmap
   113 000000F3                                 _sheet_refreshmap:
   114 000000F3 55                              	PUSH	EBP
   115 000000F4 89 E5                           	MOV	EBP,ESP
   116 000000F6 57                              	PUSH	EDI
   117 000000F7 56                              	PUSH	ESI
   118 000000F8 53                              	PUSH	EBX
   119 000000F9 83 EC 30                        	SUB	ESP,48
   120 000000FC 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   121 000000FF 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   122 00000103 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   123 00000106 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   124 00000109 0F 88 00000203                  	JS	L85
   125 0000010F                                 L26:
   126 0000010F 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   127 00000113 0F 88 000001ED                  	JS	L86
   128 00000119                                 L27:
   129 00000119 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   130 0000011C 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   131 0000011F 39 45 14                        	CMP	DWORD [20+EBP],EAX
   132 00000122 7E 03                           	JLE	L28
   133 00000124 89 45 14                        	MOV	DWORD [20+EBP],EAX
   134 00000127                                 L28:
   135 00000127 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   136 0000012A 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   137 0000012D 39 45 18                        	CMP	DWORD [24+EBP],EAX
   138 00000130 7E 03                           	JLE	L29
   139 00000132 89 45 18                        	MOV	DWORD [24+EBP],EAX
   140 00000135                                 L29:
   141 00000135 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   142 00000138 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   143 0000013B 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   144 0000013E 3B 5E 10                        	CMP	EBX,DWORD [16+ESI]
   145 00000141 0F 8F 000000DA                  	JG	L75
   146 00000147                                 L73:
   147 00000147 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   148 0000014A 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   149 0000014D 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   150 00000150 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   151 00000153 8B 7C 82 18                     	MOV	EDI,DWORD [24+EDX+EAX*4]
   152 00000157 89 F8                           	MOV	EAX,EDI
   153 00000159 29 D0                           	SUB	EAX,EDX
   154 0000015B 8B 0F                           	MOV	ECX,DWORD [EDI]
   155 0000015D 2D 00000418                     	SUB	EAX,1048
   156 00000162 89 4D D4                        	MOV	DWORD [-44+EBP],ECX
   157 00000165 C1 F8 03                        	SAR	EAX,3
   158 00000168 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   159 0000016B 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   160 00000171 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   161 00000174 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   162 00000177 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   163 0000017A 29 D3                           	SUB	EBX,EDX
   164 0000017C 29 C6                           	SUB	ESI,EAX
   165 0000017E 29 C1                           	SUB	ECX,EAX
   166 00000180 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   167 00000183 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   168 00000186 29 D0                           	SUB	EAX,EDX
   169 00000188 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   170 0000018B 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   171 0000018E 0F 88 00000166                  	JS	L87
   172 00000194                                 L34:
   173 00000194 85 C9                           	TEST	ECX,ECX
   174 00000196 0F 88 00000157                  	JS	L88
   175 0000019C                                 L35:
   176 0000019C 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   177 0000019F 39 45 E8                        	CMP	DWORD [-24+EBP],EAX
   178 000001A2 7E 03                           	JLE	L36
   179 000001A4 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   180 000001A7                                 L36:
   181 000001A7 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   182 000001AA 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   183 000001AD 7E 03                           	JLE	L37
   184 000001AF 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   185 000001B2                                 L37:
   186 000001B2 83 7F 14 FF                     	CMP	DWORD [20+EDI],-1
   187 000001B6 74 71                           	JE	L89
   188 000001B8 89 CA                           	MOV	EDX,ECX
   189 000001BA 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   190 000001BD 7D 50                           	JGE	L32
   191 000001BF                                 L72:
   192 000001BF 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   193 000001C2 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   194 000001C5 01 D0                           	ADD	EAX,EDX
   195 000001C7 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   196 000001CA 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   197 000001CD 7D 3A                           	JGE	L84
   198 000001CF                                 L71:
   199 000001CF 89 D0                           	MOV	EAX,EDX
   200 000001D1 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   201 000001D4 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   202 000001D8 01 C8                           	ADD	EAX,ECX
   203 000001DA 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   204 000001DD 01 CB                           	ADD	EBX,ECX
   205 000001DF 0F B7 34 46                     	MOVZX	ESI,WORD [ESI+EAX*2]
   206 000001E3 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   207 000001E6 3B 77 14                        	CMP	ESI,DWORD [20+EDI]
   208 000001E9 74 18                           	JE	L68
   209 000001EB 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   210 000001EE 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   211 000001F1 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   212 000001F4 0F AF 58 08                     	IMUL	EBX,DWORD [8+EAX]
   213 000001F8 01 DE                           	ADD	ESI,EBX
   214 000001FA 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   215 000001FD 8B 5D D8                        	MOV	EBX,DWORD [-40+EBP]
   216 00000200 88 04 1E                        	MOV	BYTE [ESI+EBX*1],AL
   217 00000203                                 L68:
   218 00000203 41                              	INC	ECX
   219 00000204 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   220 00000207 7C C6                           	JL	L71
   221 00000209                                 L84:
   222 00000209 42                              	INC	EDX
   223 0000020A 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   224 0000020D 7C B0                           	JL	L72
   225 0000020F                                 L32:
   226 0000020F 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   227 00000212 FF 45 F0                        	INC	DWORD [-16+EBP]
   228 00000215 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   229 00000218 3B 70 10                        	CMP	ESI,DWORD [16+EAX]
   230 0000021B 0F 8E FFFFFF26                  	JLE	L73
   231 00000221                                 L75:
   232 00000221 83 C4 30                        	ADD	ESP,48
   233 00000224 5B                              	POP	EBX
   234 00000225 5E                              	POP	ESI
   235 00000226 5F                              	POP	EDI
   236 00000227 5D                              	POP	EBP
   237 00000228 C3                              	RET
   238 00000229                                 L89:
   239 00000229 83 E2 03                        	AND	EDX,3
   240 0000022C 75 7F                           	JNE	L39
   241 0000022E F7 45 EC 00000003               	TEST	DWORD [-20+EBP],3
   242 00000235 75 76                           	JNE	L39
   243 00000237 F7 45 E8 00000003               	TEST	DWORD [-24+EBP],3
   244 0000023E 75 6D                           	JNE	L39
   245 00000240 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   246 00000243 29 55 E8                        	SUB	DWORD [-24+EBP],EDX
   247 00000246 BA 00000004                     	MOV	EDX,4
   248 0000024B 89 D3                           	MOV	EBX,EDX
   249 0000024D 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   250 00000250 99                              	CDQ
   251 00000251 F7 FB                           	IDIV	EBX
   252 00000253 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   253 00000256 89 CA                           	MOV	EDX,ECX
   254 00000258 0F B6 45 DF                     	MOVZX	EAX,BYTE [-33+EBP]
   255 0000025C 89 C6                           	MOV	ESI,EAX
   256 0000025E C1 E6 08                        	SAL	ESI,8
   257 00000261 09 C6                           	OR	ESI,EAX
   258 00000263 C1 E0 10                        	SAL	EAX,16
   259 00000266 09 C6                           	OR	ESI,EAX
   260 00000268 C1 E0 08                        	SAL	EAX,8
   261 0000026B 09 C6                           	OR	ESI,EAX
   262 0000026D 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   263 00000270 89 75 E0                        	MOV	DWORD [-32+EBP],ESI
   264 00000273 7D 9A                           	JGE	L32
   265 00000275                                 L49:
   266 00000275 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   267 00000278 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   268 0000027B 01 D0                           	ADD	EAX,EDX
   269 0000027D 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   270 00000280 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   271 00000284 03 4F 0C                        	ADD	ECX,DWORD [12+EDI]
   272 00000287 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   273 0000028A 01 C8                           	ADD	EAX,ECX
   274 0000028C 31 C9                           	XOR	ECX,ECX
   275 0000028E 03 45 D8                        	ADD	EAX,DWORD [-40+EBP]
   276 00000291 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   277 00000294 7D 0C                           	JGE	L78
   278 00000296                                 L48:
   279 00000296 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   280 00000299 89 34 88                        	MOV	DWORD [EAX+ECX*4],ESI
   281 0000029C 41                              	INC	ECX
   282 0000029D 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   283 000002A0 7C F4                           	JL	L48
   284 000002A2                                 L78:
   285 000002A2 42                              	INC	EDX
   286 000002A3 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   287 000002A6 7C CD                           	JL	L49
   288 000002A8 E9 FFFFFF62                     	JMP	L32
   289 000002AD                                 L39:
   290 000002AD 89 CA                           	MOV	EDX,ECX
   291 000002AF 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   292 000002B2 0F 8D FFFFFF57                  	JGE	L32
   293 000002B8                                 L60:
   294 000002B8 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   295 000002BB 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   296 000002BE 01 D0                           	ADD	EAX,EDX
   297 000002C0 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   298 000002C3 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   299 000002C6 7D 20                           	JGE	L81
   300 000002C8                                 L59:
   301 000002C8 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   302 000002CB 8B 45 C4                        	MOV	EAX,DWORD [-60+EBP]
   303 000002CE 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   304 000002D1 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   305 000002D5 01 CB                           	ADD	EBX,ECX
   306 000002D7 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   307 000002DA 01 C3                           	ADD	EBX,EAX
   308 000002DC 41                              	INC	ECX
   309 000002DD 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   310 000002E0 88 04 33                        	MOV	BYTE [EBX+ESI*1],AL
   311 000002E3 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   312 000002E6 7C E0                           	JL	L59
   313 000002E8                                 L81:
   314 000002E8 42                              	INC	EDX
   315 000002E9 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   316 000002EC 7C CA                           	JL	L60
   317 000002EE E9 FFFFFF1C                     	JMP	L32
   318 000002F3                                 L88:
   319 000002F3 31 C9                           	XOR	ECX,ECX
   320 000002F5 E9 FFFFFEA2                     	JMP	L35
   321 000002FA                                 L87:
   322 000002FA C7 45 EC 00000000               	MOV	DWORD [-20+EBP],0
   323 00000301 E9 FFFFFE8E                     	JMP	L34
   324 00000306                                 L86:
   325 00000306 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   326 0000030D E9 FFFFFE07                     	JMP	L27
   327 00000312                                 L85:
   328 00000312 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   329 00000319 E9 FFFFFDF1                     	JMP	L26
   330 0000031E                                 	GLOBAL	_sheet_refreshsub
   331 0000031E                                 _sheet_refreshsub:
   332 0000031E 55                              	PUSH	EBP
   333 0000031F 89 E5                           	MOV	EBP,ESP
   334 00000321 57                              	PUSH	EDI
   335 00000322 56                              	PUSH	ESI
   336 00000323 53                              	PUSH	EBX
   337 00000324 83 EC 54                        	SUB	ESP,84
   338 00000327 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   339 0000032A 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   340 0000032D 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   341 00000331 8B 00                           	MOV	EAX,DWORD [EAX]
   342 00000333 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   343 00000336 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   344 00000339 89 55 CC                        	MOV	DWORD [-52+EBP],EDX
   345 0000033C 0F 88 000003AD                  	JS	L171
   346 00000342                                 L91:
   347 00000342 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   348 00000346 0F 88 00000397                  	JS	L172
   349 0000034C                                 L92:
   350 0000034C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   351 0000034F 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   352 00000352 39 45 14                        	CMP	DWORD [20+EBP],EAX
   353 00000355 7E 03                           	JLE	L93
   354 00000357 89 45 14                        	MOV	DWORD [20+EBP],EAX
   355 0000035A                                 L93:
   356 0000035A 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   357 0000035D 8B 42 0C                        	MOV	EAX,DWORD [12+EDX]
   358 00000360 39 45 18                        	CMP	DWORD [24+EBP],EAX
   359 00000363 7E 03                           	JLE	L94
   360 00000365 89 45 18                        	MOV	DWORD [24+EBP],EAX
   361 00000368                                 L94:
   362 00000368 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   363 0000036B 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   364 0000036E 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   365 00000371 39 C3                           	CMP	EBX,EAX
   366 00000373 0F 8F 000001F6                  	JG	L158
   367 00000379                                 L156:
   368 00000379 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   369 0000037C 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   370 0000037F 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   371 00000382 8B 7C 93 18                     	MOV	EDI,DWORD [24+EBX+EDX*4]
   372 00000386 8B 07                           	MOV	EAX,DWORD [EDI]
   373 00000388 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   374 0000038B 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   375 0000038E 89 55 B8                        	MOV	DWORD [-72+EBP],EDX
   376 00000391 89 F8                           	MOV	EAX,EDI
   377 00000393 29 D8                           	SUB	EAX,EBX
   378 00000395 8B 5F 10                        	MOV	EBX,DWORD [16+EDI]
   379 00000398 2D 00000418                     	SUB	EAX,1048
   380 0000039D 29 D9                           	SUB	ECX,EBX
   381 0000039F C1 F8 03                        	SAR	EAX,3
   382 000003A2 89 5D B4                        	MOV	DWORD [-76+EBP],EBX
   383 000003A5 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   384 000003AB 88 45 CB                        	MOV	BYTE [-53+EBP],AL
   385 000003AE 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   386 000003B1 29 D0                           	SUB	EAX,EDX
   387 000003B3 8B 55 18                        	MOV	EDX,DWORD [24+EBP]
   388 000003B6 29 DA                           	SUB	EDX,EBX
   389 000003B8 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   390 000003BB 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   391 000003BE 89 55 E0                        	MOV	DWORD [-32+EBP],EDX
   392 000003C1 2B 5D B8                        	SUB	EBX,DWORD [-72+EBP]
   393 000003C4 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   394 000003C7 0F 88 0000030A                  	JS	L173
   395 000003CD                                 L99:
   396 000003CD 85 C9                           	TEST	ECX,ECX
   397 000003CF 0F 88 000002FB                  	JS	L174
   398 000003D5                                 L100:
   399 000003D5 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   400 000003D8 89 45 B0                        	MOV	DWORD [-80+EBP],EAX
   401 000003DB 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   402 000003DE 7E 03                           	JLE	L101
   403 000003E0 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   404 000003E3                                 L101:
   405 000003E3 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   406 000003E6 39 45 E0                        	CMP	DWORD [-32+EBP],EAX
   407 000003E9 7E 03                           	JLE	L102
   408 000003EB 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   409 000003EE                                 L102:
   410 000003EE 80 3D 00000FF2 08               	CMP	BYTE [4082],8
   411 000003F5 0F 84 00000276                  	JE	L175
   412 000003FB F7 45 B8 00000002               	TEST	DWORD [-72+EBP],2
   413 00000402 0F 85 000001F3                  	JNE	L116
   414 00000408 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   415 0000040B BE 00000002                     	MOV	ESI,2
   416 00000410 42                              	INC	EDX
   417 00000411 89 D0                           	MOV	EAX,EDX
   418 00000413 99                              	CDQ
   419 00000414 F7 FE                           	IDIV	ESI
   420 00000416 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   421 00000419 8B 45 E4                        	MOV	EAX,DWORD [-28+EBP]
   422 0000041C 99                              	CDQ
   423 0000041D F7 FE                           	IDIV	ESI
   424 0000041F 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   425 00000422 89 CE                           	MOV	ESI,ECX
   426 00000424 29 D0                           	SUB	EAX,EDX
   427 00000426 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   428 00000429 66 0F B6 5D CB                  	MOVZX	BX,BYTE [-53+EBP]
   429 0000042E 0F B6 45 CB                     	MOVZX	EAX,BYTE [-53+EBP]
   430 00000432 C1 E0 08                        	SAL	EAX,8
   431 00000435 66 89 5D C2                     	MOV	WORD [-62+EBP],BX
   432 00000439 66 09 45 C2                     	OR	WORD [-62+EBP],AX
   433 0000043D 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   434 00000440 0F 8D 0000011A                  	JGE	L97
   435 00000446                                 L143:
   436 00000446 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   437 00000449 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   438 0000044C 01 F0                           	ADD	EAX,ESI
   439 0000044E 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   440 00000451 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   441 00000454 7D 37                           	JGE	L122
   442 00000456 F7 C1 00000001                  	TEST	ECX,1
   443 0000045C 74 2F                           	JE	L122
   444 0000045E                                 L127:
   445 0000045E 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   446 00000461 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   447 00000464 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   448 00000467 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   449 0000046B 01 CA                           	ADD	EDX,ECX
   450 0000046D 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   451 00000470 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   452 00000473 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   453 00000476 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   454 00000479 0F 84 00000161                  	JE	L176
   455 0000047F                                 L123:
   456 0000047F 41                              	INC	ECX
   457 00000480 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   458 00000483 7D 08                           	JGE	L122
   459 00000485 F7 C1 00000001                  	TEST	ECX,1
   460 0000048B 75 D1                           	JNE	L127
   461 0000048D                                 L122:
   462 0000048D 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   463 00000490 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   464 00000493 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   465 00000496 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   466 0000049A 01 CA                           	ADD	EDX,ECX
   467 0000049C 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   468 0000049F 01 D0                           	ADD	EAX,EDX
   469 000004A1 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   470 000004A4 01 C2                           	ADD	EDX,EAX
   471 000004A6 8D 04 43                        	LEA	EAX,DWORD [EBX+EAX*2]
   472 000004A9 89 55 BC                        	MOV	DWORD [-68+EBP],EDX
   473 000004AC 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   474 000004AF 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   475 000004B2 89 F0                           	MOV	EAX,ESI
   476 000004B4 8B 5D DC                        	MOV	EBX,DWORD [-36+EBP]
   477 000004B7 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   478 000004BB 01 C8                           	ADD	EAX,ECX
   479 000004BD C7 45 A0 00000000               	MOV	DWORD [-96+EBP],0
   480 000004C4 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   481 000004C7 39 5D A0                        	CMP	DWORD [-96+EBP],EBX
   482 000004CA 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   483 000004CD 7D 59                           	JGE	L165
   484 000004CF 89 4D AC                        	MOV	DWORD [-84+EBP],ECX
   485 000004D2                                 L136:
   486 000004D2 66 8B 5D C2                     	MOV	BX,WORD [-62+EBP]
   487 000004D6 8B 45 A0                        	MOV	EAX,DWORD [-96+EBP]
   488 000004D9 8B 55 BC                        	MOV	EDX,DWORD [-68+EBP]
   489 000004DC 66 39 1C 42                     	CMP	WORD [EDX+EAX*2],BX
   490 000004E0 0F 84 000000E6                  	JE	L177
   491 000004E6 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   492 000004E9 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   493 000004EC 8B 55 AC                        	MOV	EDX,DWORD [-84+EBP]
   494 000004EF 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   495 000004F3 03 57 0C                        	ADD	EDX,DWORD [12+EDI]
   496 000004F6 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   497 000004F9 01 C2                           	ADD	EDX,EAX
   498 000004FB 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   499 000004FE 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   500 00000501 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   501 00000504 0F 84 000000A3                  	JE	L178
   502 0000050A                                 L134:
   503 0000050A 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   504 0000050D 8B 55 A4                        	MOV	EDX,DWORD [-92+EBP]
   505 00000510 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   506 00000513 38 5C 02 01                     	CMP	BYTE [1+EDX+EAX*1],BL
   507 00000517 74 76                           	JE	L179
   508 00000519                                 L130:
   509 00000519 8B 45 DC                        	MOV	EAX,DWORD [-36+EBP]
   510 0000051C FF 45 A0                        	INC	DWORD [-96+EBP]
   511 0000051F 83 45 AC 02                     	ADD	DWORD [-84+EBP],2
   512 00000523 39 45 A0                        	CMP	DWORD [-96+EBP],EAX
   513 00000526 7C AA                           	JL	L136
   514 00000528                                 L165:
   515 00000528 8B 55 DC                        	MOV	EDX,DWORD [-36+EBP]
   516 0000052B 8D 0C 51                        	LEA	ECX,DWORD [ECX+EDX*2]
   517 0000052E 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   518 00000531 7D 23                           	JGE	L167
   519 00000533                                 L142:
   520 00000533 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   521 00000536 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   522 00000539 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   523 0000053C 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   524 00000540 01 CA                           	ADD	EDX,ECX
   525 00000542 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   526 00000545 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   527 00000548 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   528 0000054B 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   529 0000054E 74 27                           	JE	L180
   530 00000550                                 L139:
   531 00000550 41                              	INC	ECX
   532 00000551 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   533 00000554 7C DD                           	JL	L142
   534 00000556                                 L167:
   535 00000556 46                              	INC	ESI
   536 00000557 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   537 0000055A 0F 8C FFFFFEE6                  	JL	L143
   538 00000560                                 L97:
   539 00000560 8B 5D 20                        	MOV	EBX,DWORD [32+EBP]
   540 00000563 FF 45 F0                        	INC	DWORD [-16+EBP]
   541 00000566 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   542 00000569 0F 8E FFFFFE0A                  	JLE	L156
   543 0000056F                                 L158:
   544 0000056F 83 C4 54                        	ADD	ESP,84
   545 00000572 5B                              	POP	EBX
   546 00000573 5E                              	POP	ESI
   547 00000574 5F                              	POP	EDI
   548 00000575 5D                              	POP	EBP
   549 00000576 C3                              	RET
   550 00000577                                 L180:
   551 00000577 89 F0                           	MOV	EAX,ESI
   552 00000579 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   553 0000057C 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   554 00000580 01 C8                           	ADD	EAX,ECX
   555 00000582 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   556 00000586 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   557 00000589 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   558 0000058D EB C1                           	JMP	L139
   559 0000058F                                 L179:
   560 0000058F 89 F0                           	MOV	EAX,ESI
   561 00000591 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   562 00000594 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   563 00000598 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   564 0000059B 66 8B 44 43 02                  	MOV	AX,WORD [2+EBX+EAX*2]
   565 000005A0 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   566 000005A3 66 89 44 53 02                  	MOV	WORD [2+EBX+EDX*2],AX
   567 000005A8 E9 FFFFFF6C                     	JMP	L130
   568 000005AD                                 L178:
   569 000005AD 89 F0                           	MOV	EAX,ESI
   570 000005AF 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   571 000005B2 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   572 000005B6 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   573 000005B9 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   574 000005BC 66 8B 04 42                     	MOV	AX,WORD [EDX+EAX*2]
   575 000005C0 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   576 000005C3 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   577 000005C7 E9 FFFFFF3E                     	JMP	L134
   578 000005CC                                 L177:
   579 000005CC 8B 55 D4                        	MOV	EDX,DWORD [-44+EBP]
   580 000005CF 8B 5D A0                        	MOV	EBX,DWORD [-96+EBP]
   581 000005D2 8B 04 82                        	MOV	EAX,DWORD [EDX+EAX*4]
   582 000005D5 8B 55 D8                        	MOV	EDX,DWORD [-40+EBP]
   583 000005D8 89 04 9A                        	MOV	DWORD [EDX+EBX*4],EAX
   584 000005DB E9 FFFFFF39                     	JMP	L130
   585 000005E0                                 L176:
   586 000005E0 89 F0                           	MOV	EAX,ESI
   587 000005E2 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   588 000005E5 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   589 000005E9 01 C8                           	ADD	EAX,ECX
   590 000005EB 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   591 000005EF 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   592 000005F2 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   593 000005F6 E9 FFFFFE84                     	JMP	L123
   594 000005FB                                 L116:
   595 000005FB 89 CE                           	MOV	ESI,ECX
   596 000005FD 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   597 00000600 0F 8D FFFFFF5A                  	JGE	L97
   598 00000606 8B 7D B0                        	MOV	EDI,DWORD [-80+EBP]
   599 00000609 0F AF F9                        	IMUL	EDI,ECX
   600 0000060C                                 L155:
   601 0000060C 8B 45 B4                        	MOV	EAX,DWORD [-76+EBP]
   602 0000060F 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   603 00000612 01 F0                           	ADD	EAX,ESI
   604 00000614 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   605 00000617 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   606 0000061A 7D 35                           	JGE	L170
   607 0000061C 8D 04 39                        	LEA	EAX,DWORD [ECX+EDI*1]
   608 0000061F 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   609 00000622 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   610 00000625 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   611 00000628                                 L154:
   612 00000628 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   613 0000062B 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   614 0000062E 8B 55 B8                        	MOV	EDX,DWORD [-72+EBP]
   615 00000631 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   616 00000635 01 CA                           	ADD	EDX,ECX
   617 00000637 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   618 0000063A 01 C2                           	ADD	EDX,EAX
   619 0000063C 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   620 0000063F 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   621 00000642 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   622 00000645 74 18                           	JE	L181
   623 00000647                                 L151:
   624 00000647 41                              	INC	ECX
   625 00000648 83 45 A0 02                     	ADD	DWORD [-96+EBP],2
   626 0000064C 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   627 0000064F 7C D7                           	JL	L154
   628 00000651                                 L170:
   629 00000651 46                              	INC	ESI
   630 00000652 03 7D B0                        	ADD	EDI,DWORD [-80+EBP]
   631 00000655 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   632 00000658 7C B2                           	JL	L155
   633 0000065A E9 FFFFFF01                     	JMP	L97
   634 0000065F                                 L181:
   635 0000065F 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   636 00000662 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   637 00000665 66 8B 02                        	MOV	AX,WORD [EDX]
   638 00000668 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   639 0000066B 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   640 0000066F EB D6                           	JMP	L151
   641 00000671                                 L175:
   642 00000671 89 CE                           	MOV	ESI,ECX
   643 00000673 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   644 00000676 0F 8D FFFFFEE4                  	JGE	L97
   645 0000067C                                 L114:
   646 0000067C 8B 57 10                        	MOV	EDX,DWORD [16+EDI]
   647 0000067F 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   648 00000682 01 F2                           	ADD	EDX,ESI
   649 00000684 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   650 00000687 89 55 EC                        	MOV	DWORD [-20+EBP],EDX
   651 0000068A 7D 23                           	JGE	L161
   652 0000068C                                 L113:
   653 0000068C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   654 0000068F 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   655 00000692 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   656 00000695 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   657 00000699 01 CA                           	ADD	EDX,ECX
   658 0000069B 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   659 0000069E 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   660 000006A1 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   661 000006A4 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   662 000006A7 74 11                           	JE	L182
   663 000006A9                                 L110:
   664 000006A9 41                              	INC	ECX
   665 000006AA 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   666 000006AD 7C DD                           	JL	L113
   667 000006AF                                 L161:
   668 000006AF 46                              	INC	ESI
   669 000006B0 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   670 000006B3 7C C7                           	JL	L114
   671 000006B5 E9 FFFFFEA6                     	JMP	L97
   672 000006BA                                 L182:
   673 000006BA 89 F0                           	MOV	EAX,ESI
   674 000006BC 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   675 000006BF 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   676 000006C3 01 C8                           	ADD	EAX,ECX
   677 000006C5 8A 04 43                        	MOV	AL,BYTE [EBX+EAX*2]
   678 000006C8 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   679 000006CB 88 04 1A                        	MOV	BYTE [EDX+EBX*1],AL
   680 000006CE EB D9                           	JMP	L110
   681 000006D0                                 L174:
   682 000006D0 31 C9                           	XOR	ECX,ECX
   683 000006D2 E9 FFFFFCFE                     	JMP	L100
   684 000006D7                                 L173:
   685 000006D7 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   686 000006DE E9 FFFFFCEA                     	JMP	L99
   687 000006E3                                 L172:
   688 000006E3 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   689 000006EA E9 FFFFFC5D                     	JMP	L92
   690 000006EF                                 L171:
   691 000006EF C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   692 000006F6 E9 FFFFFC47                     	JMP	L91
   693 000006FB                                 	GLOBAL	_sheet_updown
   694 000006FB                                 _sheet_updown:
   695 000006FB 55                              	PUSH	EBP
   696 000006FC 89 E5                           	MOV	EBP,ESP
   697 000006FE 57                              	PUSH	EDI
   698 000006FF 56                              	PUSH	ESI
   699 00000700 53                              	PUSH	EBX
   700 00000701 51                              	PUSH	ECX
   701 00000702 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   702 00000705 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   703 00000708 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   704 0000070B 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   705 0000070E 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   706 00000711 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   707 00000714 40                              	INC	EAX
   708 00000715 39 C3                           	CMP	EBX,EAX
   709 00000717 7E 02                           	JLE	L184
   710 00000719 89 C3                           	MOV	EBX,EAX
   711 0000071B                                 L184:
   712 0000071B 83 FB 9C                        	CMP	EBX,-100
   713 0000071E 7E 08                           	JLE	L185
   714 00000720 83 FB FF                        	CMP	EBX,-1
   715 00000723 7D 03                           	JGE	L185
   716 00000725 83 CB FF                        	OR	EBX,-1
   717 00000728                                 L185:
   718 00000728 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   719 0000072B 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   720 0000072E 0F 8E 000000A8                  	JLE	L186
   721 00000734 85 DB                           	TEST	EBX,EBX
   722 00000736 78 5C                           	JS	L187
   723 00000738 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   724 0000073B                                 L192:
   725 0000073B 8B 44 8E 14                     	MOV	EAX,DWORD [20+ESI+ECX*4]
   726 0000073F 89 44 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EAX
   727 00000743 89 48 18                        	MOV	DWORD [24+EAX],ECX
   728 00000746 49                              	DEC	ECX
   729 00000747 39 D9                           	CMP	ECX,EBX
   730 00000749 7F F0                           	JG	L192
   731 0000074B 89 7C 9E 18                     	MOV	DWORD [24+ESI+EBX*4],EDI
   732 0000074F 43                              	INC	EBX
   733 00000750 53                              	PUSH	EBX
   734 00000751 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   735 00000754 89 C8                           	MOV	EAX,ECX
   736 00000756 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   737 00000759 50                              	PUSH	EAX
   738 0000075A 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   739 0000075D 89 D0                           	MOV	EAX,EDX
   740 0000075F 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   741 00000762 50                              	PUSH	EAX
   742 00000763 51                              	PUSH	ECX
   743 00000764 52                              	PUSH	EDX
   744 00000765 56                              	PUSH	ESI
   745 00000766 E8 FFFFF988                     	CALL	_sheet_refreshmap
   746 0000076B FF 75 F0                        	PUSH	DWORD [-16+EBP]
   747 0000076E                                 L222:
   748 0000076E 53                              	PUSH	EBX
   749 0000076F                                 L221:
   750 0000076F 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   751 00000772 89 C8                           	MOV	EAX,ECX
   752 00000774 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   753 00000777 50                              	PUSH	EAX
   754 00000778 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   755 0000077B 89 D0                           	MOV	EAX,EDX
   756 0000077D 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   757 00000780 50                              	PUSH	EAX
   758 00000781 51                              	PUSH	ECX
   759 00000782 52                              	PUSH	EDX
   760 00000783 56                              	PUSH	ESI
   761 00000784 E8 FFFFFB95                     	CALL	_sheet_refreshsub
   762 00000789 83 C4 34                        	ADD	ESP,52
   763 0000078C                                 L183:
   764 0000078C 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   765 0000078F 5B                              	POP	EBX
   766 00000790 5E                              	POP	ESI
   767 00000791 5F                              	POP	EDI
   768 00000792 5D                              	POP	EBP
   769 00000793 C3                              	RET
   770 00000794                                 L187:
   771 00000794 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   772 00000797 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   773 0000079A 7E 18                           	JLE	L194
   774 0000079C 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   775 0000079F 39 C1                           	CMP	ECX,EAX
   776 000007A1 7D 11                           	JGE	L194
   777 000007A3                                 L199:
   778 000007A3 8B 44 8E 1C                     	MOV	EAX,DWORD [28+ESI+ECX*4]
   779 000007A7 89 44 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EAX
   780 000007AB 89 48 18                        	MOV	DWORD [24+EAX],ECX
   781 000007AE 41                              	INC	ECX
   782 000007AF 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   783 000007B2 7C EF                           	JL	L199
   784 000007B4                                 L194:
   785 000007B4 FF 4E 10                        	DEC	DWORD [16+ESI]
   786 000007B7 6A 00                           	PUSH	0
   787 000007B9 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   788 000007BC 89 C8                           	MOV	EAX,ECX
   789 000007BE 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   790 000007C1 50                              	PUSH	EAX
   791 000007C2 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   792 000007C5 89 D0                           	MOV	EAX,EDX
   793 000007C7 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   794 000007CA 50                              	PUSH	EAX
   795 000007CB 51                              	PUSH	ECX
   796 000007CC 52                              	PUSH	EDX
   797 000007CD 56                              	PUSH	ESI
   798 000007CE E8 FFFFF920                     	CALL	_sheet_refreshmap
   799 000007D3 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   800 000007D6 48                              	DEC	EAX
   801 000007D7 50                              	PUSH	EAX
   802 000007D8 6A 00                           	PUSH	0
   803 000007DA EB 93                           	JMP	L221
   804 000007DC                                 L186:
   805 000007DC 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   806 000007DF 7D AB                           	JGE	L183
   807 000007E1 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   808 000007E5 78 3C                           	JS	L202
   809 000007E7 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   810 000007EA 39 D9                           	CMP	ECX,EBX
   811 000007EC 7D 10                           	JGE	L218
   812 000007EE                                 L207:
   813 000007EE 8B 44 8E 1C                     	MOV	EAX,DWORD [28+ESI+ECX*4]
   814 000007F2 89 44 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EAX
   815 000007F6 89 48 18                        	MOV	DWORD [24+EAX],ECX
   816 000007F9 41                              	INC	ECX
   817 000007FA 39 D9                           	CMP	ECX,EBX
   818 000007FC 7C F0                           	JL	L207
   819 000007FE                                 L218:
   820 000007FE 89 7C 9E 18                     	MOV	DWORD [24+ESI+EBX*4],EDI
   821 00000802                                 L208:
   822 00000802 53                              	PUSH	EBX
   823 00000803 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   824 00000806 89 C8                           	MOV	EAX,ECX
   825 00000808 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   826 0000080B 50                              	PUSH	EAX
   827 0000080C 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   828 0000080F 89 D0                           	MOV	EAX,EDX
   829 00000811 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   830 00000814 50                              	PUSH	EAX
   831 00000815 51                              	PUSH	ECX
   832 00000816 52                              	PUSH	EDX
   833 00000817 56                              	PUSH	ESI
   834 00000818 E8 FFFFF8D6                     	CALL	_sheet_refreshmap
   835 0000081D 53                              	PUSH	EBX
   836 0000081E E9 FFFFFF4B                     	JMP	L222
   837 00000823                                 L202:
   838 00000823 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   839 00000826 39 D9                           	CMP	ECX,EBX
   840 00000828 7C 13                           	JL	L220
   841 0000082A                                 L213:
   842 0000082A 8B 54 8E 18                     	MOV	EDX,DWORD [24+ESI+ECX*4]
   843 0000082E 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   844 00000831 89 54 8E 1C                     	MOV	DWORD [28+ESI+ECX*4],EDX
   845 00000835 49                              	DEC	ECX
   846 00000836 89 42 18                        	MOV	DWORD [24+EDX],EAX
   847 00000839 39 D9                           	CMP	ECX,EBX
   848 0000083B 7D ED                           	JGE	L213
   849 0000083D                                 L220:
   850 0000083D 89 7C 9E 18                     	MOV	DWORD [24+ESI+EBX*4],EDI
   851 00000841 FF 46 10                        	INC	DWORD [16+ESI]
   852 00000844 EB BC                           	JMP	L208
   853 00000846                                 	GLOBAL	_sheet_refresh
   854 00000846                                 _sheet_refresh:
   855 00000846 55                              	PUSH	EBP
   856 00000847 89 E5                           	MOV	EBP,ESP
   857 00000849 53                              	PUSH	EBX
   858 0000084A 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   859 0000084D 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   860 00000850 85 C0                           	TEST	EAX,EAX
   861 00000852 78 27                           	JS	L223
   862 00000854 50                              	PUSH	EAX
   863 00000855 50                              	PUSH	EAX
   864 00000856 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   865 00000859 89 C8                           	MOV	EAX,ECX
   866 0000085B 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   867 0000085E 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   868 00000861 50                              	PUSH	EAX
   869 00000862 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   870 00000865 89 D0                           	MOV	EAX,EDX
   871 00000867 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   872 0000086A 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   873 0000086D 50                              	PUSH	EAX
   874 0000086E 51                              	PUSH	ECX
   875 0000086F 52                              	PUSH	EDX
   876 00000870 FF 73 20                        	PUSH	DWORD [32+EBX]
   877 00000873 E8 FFFFFAA6                     	CALL	_sheet_refreshsub
   878 00000878 83 C4 1C                        	ADD	ESP,28
   879 0000087B                                 L223:
   880 0000087B 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   881 0000087E C9                              	LEAVE
   882 0000087F C3                              	RET
   883 00000880                                 	GLOBAL	_sheet_slide
   884 00000880                                 _sheet_slide:
   885 00000880 55                              	PUSH	EBP
   886 00000881 89 E5                           	MOV	EBP,ESP
   887 00000883 57                              	PUSH	EDI
   888 00000884 56                              	PUSH	ESI
   889 00000885 53                              	PUSH	EBX
   890 00000886 53                              	PUSH	EBX
   891 00000887 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   892 0000088A 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   893 0000088D 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   894 00000890 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   895 00000893 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   896 00000896 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   897 00000899 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   898 0000089C 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   899 0000089F 89 43 10                        	MOV	DWORD [16+EBX],EAX
   900 000008A2 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   901 000008A6 78 7C                           	JS	L225
   902 000008A8 6A 00                           	PUSH	0
   903 000008AA 89 F0                           	MOV	EAX,ESI
   904 000008AC 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   905 000008AF 50                              	PUSH	EAX
   906 000008B0 89 F8                           	MOV	EAX,EDI
   907 000008B2 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   908 000008B5 50                              	PUSH	EAX
   909 000008B6 56                              	PUSH	ESI
   910 000008B7 57                              	PUSH	EDI
   911 000008B8 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   912 000008BB E8 FFFFF833                     	CALL	_sheet_refreshmap
   913 000008C0 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   914 000008C3 FF 73 18                        	PUSH	DWORD [24+EBX]
   915 000008C6 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   916 000008C9 50                              	PUSH	EAX
   917 000008CA 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   918 000008CD 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   919 000008D0 50                              	PUSH	EAX
   920 000008D1 FF 75 10                        	PUSH	DWORD [16+EBP]
   921 000008D4 FF 75 0C                        	PUSH	DWORD [12+EBP]
   922 000008D7 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   923 000008DA E8 FFFFF814                     	CALL	_sheet_refreshmap
   924 000008DF 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   925 000008E2 83 C4 30                        	ADD	ESP,48
   926 000008E5 48                              	DEC	EAX
   927 000008E6 50                              	PUSH	EAX
   928 000008E7 89 F0                           	MOV	EAX,ESI
   929 000008E9 6A 00                           	PUSH	0
   930 000008EB 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   931 000008EE 50                              	PUSH	EAX
   932 000008EF 89 F8                           	MOV	EAX,EDI
   933 000008F1 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   934 000008F4 50                              	PUSH	EAX
   935 000008F5 56                              	PUSH	ESI
   936 000008F6 57                              	PUSH	EDI
   937 000008F7 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   938 000008FA E8 FFFFFA1F                     	CALL	_sheet_refreshsub
   939 000008FF 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   940 00000902 FF 73 18                        	PUSH	DWORD [24+EBX]
   941 00000905 FF 73 18                        	PUSH	DWORD [24+EBX]
   942 00000908 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   943 0000090B 50                              	PUSH	EAX
   944 0000090C 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   945 0000090F 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   946 00000912 50                              	PUSH	EAX
   947 00000913 FF 75 10                        	PUSH	DWORD [16+EBP]
   948 00000916 FF 75 0C                        	PUSH	DWORD [12+EBP]
   949 00000919 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   950 0000091C E8 FFFFF9FD                     	CALL	_sheet_refreshsub
   951 00000921 83 C4 38                        	ADD	ESP,56
   952 00000924                                 L225:
   953 00000924 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   954 00000927 5B                              	POP	EBX
   955 00000928 5E                              	POP	ESI
   956 00000929 5F                              	POP	EDI
   957 0000092A 5D                              	POP	EBP
   958 0000092B C3                              	RET
   959 0000092C                                 	GLOBAL	_sheet_free
   960 0000092C                                 _sheet_free:
   961 0000092C 55                              	PUSH	EBP
   962 0000092D 89 E5                           	MOV	EBP,ESP
   963 0000092F 53                              	PUSH	EBX
   964 00000930 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   965 00000933 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   966 00000937 78 0A                           	JS	L228
   967 00000939 6A FF                           	PUSH	-1
   968 0000093B 53                              	PUSH	EBX
   969 0000093C E8 FFFFFDBA                     	CALL	_sheet_updown
   970 00000941 58                              	POP	EAX
   971 00000942 5A                              	POP	EDX
   972 00000943                                 L228:
   973 00000943 C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   974 0000094A 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   975 0000094D C9                              	LEAVE
   976 0000094E C3                              	RET
   977 0000094F                                 	GLOBAL	_sheet_view
   978 0000094F                                 _sheet_view:
   979 0000094F 55                              	PUSH	EBP
   980 00000950 31 D2                           	XOR	EDX,EDX
   981 00000952 89 E5                           	MOV	EBP,ESP
   982 00000954 53                              	PUSH	EBX
   983 00000955 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   984 00000958 89 C8                           	MOV	EAX,ECX
   985 0000095A                                 L235:
   986 0000095A 83 B8 00000430 9C               	CMP	DWORD [1072+EAX],-100
   987 00000961 74 13                           	JE	L238
   988 00000963 42                              	INC	EDX
   989 00000964 83 C0 28                        	ADD	EAX,40
   990 00000967 81 FA 000000FF                  	CMP	EDX,255
   991 0000096D 7E EB                           	JLE	L235
   992 0000096F 31 C0                           	XOR	EAX,EAX
   993 00000971                                 L229:
   994 00000971 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   995 00000974 C9                              	LEAVE
   996 00000975 C3                              	RET
   997 00000976                                 L238:
   998 00000976 8D 98 00000418                  	LEA	EBX,DWORD [1048+EAX]
   999 0000097C FF 71 10                        	PUSH	DWORD [16+ECX]
  1000 0000097F 53                              	PUSH	EBX
  1001 00000980 E8 FFFFFD76                     	CALL	_sheet_updown
  1002 00000985 89 D8                           	MOV	EAX,EBX
  1003 00000987 EB E8                           	JMP	L229
